<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>ğŸ† ×ª×¨×’×•×œ ×—×©×‘×•×Ÿ ×× ×¦×—</title>
  <meta name="description" content="××ª×¨ ×ª×¨×’×•×œ ×—×©×‘×•×Ÿ ×× ×¦×—! ×—×™×‘×•×¨, ×—×™×¡×•×¨, ×›×¤×œ ×•×—×™×œ×•×§ â€“ ×ª×¨×’×™×œ×™× ××•×ª×××™× ×œ×›×œ ×’×™×œ, ×¢× ×§×¦×‘ ××™×©×™ ×•××ª×’×¨×™× ××”× ×™×. ×”×ª×—×™×œ×• ×œ×ª×¨×’×œ ×¢×›×©×™×• â€“ ×‘×—×™× × ×•×œ×œ× ×¦×•×¨×š ×‘×”×¨×©××”!">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="site.webmanifest">
  <meta name="theme-color" content="#007bff">
  <style>
    .hidden { display: none; }
    :root { --primary:#007bff; --success:#28a745; --bg:#f0f4f8; --card:#fff; --text:#333; --radius:8px; --transition:0.3s }
    *{box-sizing:border-box}
    body{margin:0;padding:1rem;font-family:'Segoe UI',sans-serif;background:var(--bg);color:var(--text);direction:rtl}
    h1,h2{text-align:center;color:var(--primary)}
    main{max-width:600px;margin:auto}
    section{background:var(--card);border-radius:var(--radius);box-shadow:0 2px 6px rgba(0,0,0,0.1);padding:1rem;margin-bottom:1.5rem}
    fieldset{border:1px solid #ccc;border-radius:var(--radius);padding:1rem;margin-bottom:1rem}
    legend{font-weight:bold}
    .input-group{display:flex;gap:.5rem;align-items:center;margin-bottom:1rem}
    input[type="number"]{width:4rem;padding:.3rem;border:1px solid #ccc;border-radius:var(--radius)}
    button{padding:.75rem;border:none;border-radius:var(--radius);cursor:pointer;transition:transform var(--transition),background var(--transition)}
    button.primary{background:var(--primary);color:#fff;width:100%;font-size:1.1rem}
    button.primary:hover{transform:translateY(-2px)}
    #question{background:var(--card);padding:1rem;margin:1rem auto;display:inline-block;border-radius:var(--radius);font-size:1.5em;direction:ltr;text-align:center}
    .option-btn{display:block;width:100%;padding:.75rem;margin:.5rem 0;border-radius:var(--radius);font-size:1.1em}
    .correct{background:var(--success)!important;color:#fff!important}
    .wrong{background:#dc3545!important;color:#fff!important}
    #timer{text-align:center;margin-bottom:1rem}
    .progress-wrapper{display:flex;gap:.5rem;align-items:center;margin-bottom:1rem}
    progress{flex:1;height:1rem}
    #resultsList{list-style:none;padding:0}
    #resultsList li{background:#e9ecef;padding:.75rem;margin:.5rem 0;border-radius:var(--radius)}
    @media(max-width:600px){#question{font-size:1.2em}button.primary{font-size:1rem}}
  </style>
</head>
<body>
  <main>
    <h1>ğŸ† ×ª×¨×’×•×œ ×—×©×‘×•×Ÿ ×× ×¦×—</h1>
    <section id="setup">
      <h2>×”×’×“×¨×•×ª ×”×ª×¨×’×•×œ</h2>
      <fieldset><legend>×‘×—×¨ ×¡×•×’ ×ª×¨×’×™×œ×™×</legend>
        <label><input type="checkbox" name="type" value="add">×—×™×‘×•×¨</label>
        <label><input type="checkbox" name="type" value="sub">×—×™×¡×•×¨</label>
        <label><input type="checkbox" name="type" value="mul">×›×¤×œ</label>
        <label><input type="checkbox" name="type" value="div">×—×™×œ×•×§</label>
        <label><input type="checkbox" name="type" value="mix">×¢×¨×‘×•×‘</label>
      </fieldset>
      <div class="input-group"><label for="min">×</label><input id="min" type="number" min="0" value="1"><label for="max">×¢×“</label><input id="max" type="number" min="0" value="10"></div>
      <div class="input-group"><label for="count">×›××•×ª ×ª×¨×’×™×œ×™×</label><input id="count" type="number" min="1" value="5"></div>
      <div class="input-group"><label for="timePerQ">×–××Ÿ ×œ×©××œ×” (×©')</label><input id="timePerQ" type="number" min="1" value="15"></div>
      <button id="start" class="primary hidden">×”×ª×—×œ ×‘×ª×¨×’×•×œ</button>
    </section>
    <section id="quiz" class="hidden">
      <h2>×ª×¨×’×™×œ <span id="currentNum"></span> ××ª×•×š <span id="totalNum"></span></h2>
      <div class="progress-wrapper"><progress id="progress" max="100" value="0"></progress><span id="progressText">0%</span></div>
      <div id="timer">×–××Ÿ × ×•×ª×¨: <span id="timeDisplay"></span> ×©'</div>
      <div id="question"></div>
      <div id="options"></div>
      <button id="next" class="primary hidden">×”××©×š</button>
    </section>
    <section id="results" class="hidden">
      <h2>×”×ª×•×¦××•×ª ×©×œ×š</h2>
      <p id="scoreText" style="text-align:center;font-size:1.2em"></p>
      <ul id="resultsList"></ul>
      <button id="restart" class="primary">× ×¡×” ×©×•×‘</button>
    </section>
  </main>
  <script>
    document.addEventListener('DOMContentLoaded',()=>{
      const setupEl=document.getElementById('setup'),
            quizEl=document.getElementById('quiz'),
            resultsEl=document.getElementById('results'),
            startBtn=document.getElementById('start'),
            nextBtn=document.getElementById('next'),
            restartBtn=document.getElementById('restart'),
            currentNumEl=document.getElementById('currentNum'),
            totalNumEl=document.getElementById('totalNum'),
            questionEl=document.getElementById('question'),
            optionsEl=document.getElementById('options'),
            timerEl=document.getElementById('timeDisplay'),
            progressBar=document.getElementById('progress'),
            progressText=document.getElementById('progressText'),
            scoreText=document.getElementById('scoreText'),
            resultsList=document.getElementById('resultsList');
      let exercises=[],userResults=[],currentIndex=0,perQSec=15,countdown;
      const rand=(min,max)=>Math.floor(Math.random()*(max-min+1))+min;
      function genExercise(types,min,max){
        const ops=types.includes('mix')?['add','sub','mul','div']:types,
              op=ops[rand(0,ops.length-1)];
        let A=rand(min,max),B=rand(min,max),q,ans;
        switch(op){
          case 'add':q=`${A}+${B}`;ans=A+B;break;
          case 'sub':if(A<B)[A,B]=[B,A];q=`${A}-${B}`;ans=A-B;break;
          case 'mul':q=`${A}Ã—${B}`;ans=A*B;break;
          case 'div':B=rand(min,max)||1;A=B*rand(min,max);q=`${A}Ã·${B}`;ans=A/B;break;
        }
        return{q,ans};
      }
      function checkReady(){
        const types=document.querySelectorAll('input[name="type"]:checked').length,
              min=+document.getElementById('min').value,
              max=+document.getElementById('max').value,
              count=+document.getElementById('count').value,
              time=+document.getElementById('timePerQ').value;
        if(types&&min>=0&&max>=min&&count>0&&time>0) startBtn.classList.remove('hidden');
        else startBtn.classList.add('hidden');
      }
      [...setupEl.querySelectorAll('input')].forEach(i=>i.addEventListener('change',checkReady));
      // Initialize
      checkReady();
      startBtn.addEventListener('click',()=>{
        const types=[...document.querySelectorAll('input[name="type"]:checked')].map(i=>i.value),
              min=+document.getElementById('min').value,
              max=+document.getElementById('max').value,
              count=+document.getElementById('count').value;
        perQSec=+document.getElementById('timePerQ').value;
        exercises=Array.from({length:count},()=>genExercise(types,min,max));
        userResults=[];currentIndex=0;totalNumEl.textContent=exercises.length;
        setupEl.classList.add('hidden');quizEl.classList.remove('hidden');showQuestion();
      });
      nextBtn.addEventListener('click',()=>{
        currentIndex++;
        currentIndex<exercises.length?showQuestion():showResults();
      });
      restartBtn.addEventListener('click',()=>{
        resultsEl.classList.add('hidden');
        setupEl.classList.remove('hidden');
        resultsList.innerHTML='';scoreText.textContent='';
        checkReady();
      });
      function showQuestion(){
        clearInterval(countdown);
        const {q,ans}=exercises[currentIndex];
        currentNumEl.textContent=currentIndex+1;
        questionEl.textContent=q;
        optionsEl.innerHTML='';
        const choices=new Set([ans]);
        while(choices.size<4){const c=rand(ans-10,ans+10);if(c>=0)choices.add(c);}
        [...choices].sort(()=>Math.random()-.5).forEach(val=>{
          const btn=document.createElement('button');
          btn.textContent=val;btn.className='option-btn';
          btn.style.backgroundColor=['#ffadad','#ffd6a5','#caffbf','#9bf6ff'][rand(0,3)];
          btn.addEventListener('click',()=>selectAnswer(btn,val,ans));
          optionsEl.append(btn);
        });
        const pct=Math.round(currentIndex/exercises.length*100);
        progressBar.value=pct;progressText.textContent=`${pct}%`;
        let sec=perQSec;timerEl.textContent=sec;
        countdown=setInterval(()=>{
          sec--;timerEl.textContent=sec;
          if(sec<=0){clearInterval(countdown);selectAnswer(null,null,ans);}
        },1000);
        nextBtn.classList.add('hidden');
      }
      function selectAnswer(btn,val,correct){
        clearInterval(countdown);
        [...optionsEl.children].forEach(b=>{
          b.disabled=true;
          if(+b.textContent===correct) b.classList.add('correct');
        });
        if(btn&&val!==correct) btn.classList.add('wrong');
        userResults.push(btn&&val===correct);
        nextBtn.classList.remove('hidden');
      }
      function showResults(){
        quizEl.classList.add('hidden');resultsEl.classList.remove('hidden');
        const score=userResults.filter(x=>x).length;
        scoreText.textContent=`×¦×™×•×Ÿ ×¡×•×¤×™: ${score} ××ª×•×š ${exercises.length}`;
        resultsList.innerHTML='';
        userResults.forEach((ok,i)=>{
          const li=document.createElement('li');
          li.textContent=`×ª×¨×’×™×œ ${i+1}: ${ok?'âœ… × ×›×•×Ÿ':'âŒ ×©×’×•×™'}`;
          resultsList.append(li);
        });
      }
    });
  </script>
</body>
</html>
